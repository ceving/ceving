<html>
  <head>
    <title>Python Pretty Print</title>
  </head>
  <body style="font-family: monospace;">
<span style="color: green">#&nbsp;File:&nbsp;KnuthMorrisPratt.py</span><br><span style="color: green">#&nbsp;Author:&nbsp;Keith&nbsp;Schwarz&nbsp;(htiek@cs.stanford.edu)</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;An&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Knuth-Morris-Pratt&nbsp;(KMP)&nbsp;string-matching&nbsp;algorithm.</span><br><span style="color: green">#&nbsp;This&nbsp;algorithm&nbsp;takes&nbsp;as&nbsp;input&nbsp;a&nbsp;pattern&nbsp;string&nbsp;P&nbsp;and&nbsp;target&nbsp;string&nbsp;T,&nbsp;then</span><br><span style="color: green">#&nbsp;finds&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;the&nbsp;string&nbsp;T&nbsp;in&nbsp;the&nbsp;pattern&nbsp;P,&nbsp;doing&nbsp;so&nbsp;in&nbsp;time</span><br><span style="color: green">#&nbsp;O(|P|&nbsp;+&nbsp;|T|).&nbsp;&nbsp;The&nbsp;logic&nbsp;behind&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;not&nbsp;particularly&nbsp;complex,</span><br><span style="color: green">#&nbsp;though&nbsp;getting&nbsp;it&nbsp;to&nbsp;run&nbsp;in&nbsp;linear&nbsp;time&nbsp;requires&nbsp;a&nbsp;few&nbsp;non-obvious&nbsp;tricks.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;To&nbsp;motivate&nbsp;KMP,&nbsp;consider&nbsp;the&nbsp;naive&nbsp;algorithm&nbsp;for&nbsp;trying&nbsp;to&nbsp;match&nbsp;a&nbsp;pattern</span><br><span style="color: green">#&nbsp;string&nbsp;P&nbsp;against&nbsp;a&nbsp;target&nbsp;T.&nbsp;&nbsp;This&nbsp;would&nbsp;work&nbsp;by&nbsp;considering&nbsp;all&nbsp;possible</span><br><span style="color: green">#&nbsp;start&nbsp;positions&nbsp;for&nbsp;the&nbsp;pattern&nbsp;P&nbsp;in&nbsp;the&nbsp;target&nbsp;T,&nbsp;then&nbsp;checking&nbsp;whether&nbsp;a</span><br><span style="color: green">#&nbsp;match&nbsp;exists&nbsp;at&nbsp;each&nbsp;of&nbsp;those&nbsp;positions.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;match&nbsp;the&nbsp;string</span><br><span style="color: green">#&nbsp;ABC&nbsp;against&nbsp;the&nbsp;target&nbsp;string&nbsp;ABABABACCABC,&nbsp;we'd&nbsp;get</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABABABACCABC</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(first&nbsp;two&nbsp;characters&nbsp;match,&nbsp;last&nbsp;does&nbsp;not)</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(first&nbsp;character&nbsp;doesn't&nbsp;match)</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(first&nbsp;two&nbsp;characters&nbsp;match,&nbsp;last&nbsp;does&nbsp;not)</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(first&nbsp;character&nbsp;doesn't&nbsp;match)</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(first&nbsp;two&nbsp;characters&nbsp;match,&nbsp;last&nbsp;does&nbsp;not)</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(first&nbsp;character&nbsp;doesn't&nbsp;match)</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(first&nbsp;character&nbsp;matches,&nbsp;second&nbsp;doesn't)</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(first&nbsp;character&nbsp;doesn't&nbsp;match)</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(first&nbsp;character&nbsp;doesn't&nbsp;match)</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(match&nbsp;found)</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;This&nbsp;algorithm&nbsp;runs&nbsp;in&nbsp;O(mn)&nbsp;in&nbsp;the&nbsp;worst&nbsp;case,&nbsp;where&nbsp;m&nbsp;=&nbsp;|T|&nbsp;and&nbsp;n&nbsp;=&nbsp;|P|,</span><br><span style="color: green">#&nbsp;because&nbsp;it&nbsp;has&nbsp;to&nbsp;do&nbsp;O(n)&nbsp;work&nbsp;to&nbsp;check&nbsp;whether&nbsp;the&nbsp;string&nbsp;matches&nbsp;O(m)&nbsp;times</span><br><span style="color: green">#&nbsp;for&nbsp;each&nbsp;spot&nbsp;in&nbsp;the&nbsp;string.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;However,&nbsp;a&nbsp;lot&nbsp;of&nbsp;this&nbsp;is&nbsp;wasted&nbsp;work.&nbsp;&nbsp;For&nbsp;example,&nbsp;in&nbsp;the&nbsp;above&nbsp;example,</span><br><span style="color: green">#&nbsp;consider&nbsp;what&nbsp;happens&nbsp;when&nbsp;we&nbsp;know&nbsp;that&nbsp;the&nbsp;string&nbsp;ABC&nbsp;does&nbsp;not&nbsp;match&nbsp;the</span><br><span style="color: green">#&nbsp;first&nbsp;part&nbsp;of&nbsp;the&nbsp;string,&nbsp;ABA.&nbsp;&nbsp;At&nbsp;this&nbsp;point,&nbsp;it&nbsp;would&nbsp;be&nbsp;silly&nbsp;to&nbsp;actually</span><br><span style="color: green">#&nbsp;try&nbsp;to&nbsp;match&nbsp;the&nbsp;string&nbsp;at&nbsp;the&nbsp;string&nbsp;starting&nbsp;with&nbsp;the&nbsp;B,&nbsp;since&nbsp;there's&nbsp;no</span><br><span style="color: green">#&nbsp;possible&nbsp;way&nbsp;that&nbsp;the&nbsp;string&nbsp;could&nbsp;match&nbsp;there.&nbsp;&nbsp;Instead,&nbsp;it&nbsp;would&nbsp;make&nbsp;more</span><br><span style="color: green">#&nbsp;sense&nbsp;to&nbsp;instead&nbsp;start&nbsp;over&nbsp;and&nbsp;try&nbsp;matching&nbsp;ABC&nbsp;at&nbsp;the&nbsp;next&nbsp;A.&nbsp;&nbsp;In&nbsp;fact,</span><br><span style="color: green">#&nbsp;more&nbsp;generally,&nbsp;if&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;information&nbsp;we&nbsp;have&nbsp;about&nbsp;what&nbsp;characters</span><br><span style="color: green">#&nbsp;we&nbsp;already&nbsp;matched&nbsp;to&nbsp;determine&nbsp;where&nbsp;we&nbsp;should&nbsp;try&nbsp;to&nbsp;resume&nbsp;the&nbsp;search&nbsp;in</span><br><span style="color: green">#&nbsp;the&nbsp;string,&nbsp;we&nbsp;can&nbsp;avoid&nbsp;revisiting&nbsp;characters&nbsp;multiple&nbsp;times&nbsp;when&nbsp;there's&nbsp;no</span><br><span style="color: green">#&nbsp;hope&nbsp;that&nbsp;they&nbsp;could&nbsp;ever&nbsp;match.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;The&nbsp;idea&nbsp;we'll&nbsp;use&nbsp;is&nbsp;to&nbsp;look&nbsp;for&nbsp;&quot;borders&quot;&nbsp;of&nbsp;a&nbsp;string,&nbsp;which&nbsp;are&nbsp;substrings</span><br><span style="color: green">#&nbsp;that&nbsp;are&nbsp;both&nbsp;a&nbsp;prefix&nbsp;and&nbsp;suffix&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;For&nbsp;example,&nbsp;the&nbsp;string</span><br><span style="color: green">#&nbsp;&quot;aabcaa&quot;&nbsp;has&nbsp;&quot;aa&quot;&nbsp;as&nbsp;a&nbsp;border,&nbsp;while&nbsp;the&nbsp;string&nbsp;&quot;abc&quot;&nbsp;just&nbsp;has&nbsp;the&nbsp;empty</span><br><span style="color: green">#&nbsp;string&nbsp;as&nbsp;a&nbsp;border.&nbsp;&nbsp;Borders&nbsp;are&nbsp;useful&nbsp;in&nbsp;KMP&nbsp;because&nbsp;they&nbsp;encode</span><br><span style="color: green">#&nbsp;information&nbsp;about&nbsp;where&nbsp;we&nbsp;might&nbsp;need&nbsp;to&nbsp;pick&nbsp;up&nbsp;the&nbsp;search&nbsp;when&nbsp;a&nbsp;particular</span><br><span style="color: green">#&nbsp;match&nbsp;attempt&nbsp;fails.&nbsp;&nbsp;For&nbsp;example,&nbsp;suppose&nbsp;that&nbsp;we&nbsp;want&nbsp;to&nbsp;match&nbsp;ABABC</span><br><span style="color: green">#&nbsp;against&nbsp;the&nbsp;string&nbsp;ABABABC.&nbsp;&nbsp;If&nbsp;we&nbsp;start&nbsp;off&nbsp;by&nbsp;trying&nbsp;to&nbsp;match&nbsp;the&nbsp;string,</span><br><span style="color: green">#&nbsp;we'll&nbsp;find&nbsp;that&nbsp;they&nbsp;overlap&nbsp;like&nbsp;this:</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;ABABABC</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;ABABx</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;That&nbsp;is,&nbsp;the&nbsp;first&nbsp;four&nbsp;characters&nbsp;match,&nbsp;but&nbsp;the&nbsp;fifth&nbsp;does&nbsp;not.&nbsp;&nbsp;At&nbsp;this</span><br><span style="color: green">#&nbsp;point,&nbsp;rather&nbsp;than&nbsp;naively&nbsp;restarting&nbsp;the&nbsp;search&nbsp;at&nbsp;the&nbsp;second&nbsp;character&nbsp;(B),</span><br><span style="color: green">#&nbsp;or&nbsp;even&nbsp;restarting&nbsp;it&nbsp;at&nbsp;the&nbsp;third&nbsp;position&nbsp;(A),&nbsp;we&nbsp;can&nbsp;instead&nbsp;note&nbsp;that&nbsp;we</span><br><span style="color: green">#&nbsp;can&nbsp;treat&nbsp;the&nbsp;last&nbsp;two&nbsp;characters&nbsp;of&nbsp;the&nbsp;string&nbsp;we&nbsp;matched&nbsp;(AB)&nbsp;as&nbsp;the&nbsp;first</span><br><span style="color: green">#&nbsp;two&nbsp;characters&nbsp;of&nbsp;the&nbsp;pattern&nbsp;string&nbsp;ABABC&nbsp;if&nbsp;we&nbsp;just&nbsp;treated&nbsp;it&nbsp;instead&nbsp;as</span><br><span style="color: green">#&nbsp;though&nbsp;we&nbsp;had</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;ABABABC</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;ABABx</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABABC</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;If&nbsp;we&nbsp;can&nbsp;somehow&nbsp;remember&nbsp;the&nbsp;fact&nbsp;that&nbsp;we&nbsp;already&nbsp;matched&nbsp;the&nbsp;AB&nbsp;at&nbsp;the</span><br><span style="color: green">#&nbsp;start&nbsp;of&nbsp;this&nbsp;string,&nbsp;we&nbsp;could&nbsp;just&nbsp;confirm&nbsp;that&nbsp;the&nbsp;three&nbsp;characters&nbsp;after</span><br><span style="color: green">#&nbsp;it&nbsp;are&nbsp;ABC&nbsp;and&nbsp;be&nbsp;done.&nbsp;&nbsp;There's&nbsp;no&nbsp;need&nbsp;to&nbsp;confirm&nbsp;that&nbsp;the&nbsp;characters&nbsp;at</span><br><span style="color: green">#&nbsp;the&nbsp;front&nbsp;match.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;In&nbsp;order&nbsp;to&nbsp;make&nbsp;this&nbsp;possible,&nbsp;we'll&nbsp;construct&nbsp;a&nbsp;special&nbsp;data&nbsp;structure</span><br><span style="color: green">#&nbsp;called&nbsp;the&nbsp;&quot;fail&nbsp;table.&quot;&nbsp;&nbsp;This&nbsp;table&nbsp;stores,&nbsp;for&nbsp;each&nbsp;possible&nbsp;prefix&nbsp;of&nbsp;the</span><br><span style="color: green">#&nbsp;string&nbsp;to&nbsp;match,&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;longest&nbsp;border&nbsp;of&nbsp;that&nbsp;prefix.&nbsp;&nbsp;That&nbsp;way,</span><br><span style="color: green">#&nbsp;when&nbsp;we&nbsp;find&nbsp;a&nbsp;mismatch,&nbsp;we&nbsp;know&nbsp;where&nbsp;the&nbsp;next&nbsp;possible&nbsp;start&nbsp;location&nbsp;could</span><br><span style="color: green">#&nbsp;be&nbsp;found.&nbsp;&nbsp;In&nbsp;particular,&nbsp;once&nbsp;we&nbsp;have&nbsp;a&nbsp;mismatch,&nbsp;if&nbsp;there's&nbsp;any&nbsp;border&nbsp;of</span><br><span style="color: green">#&nbsp;the&nbsp;prefix&nbsp;of&nbsp;the&nbsp;pattern&nbsp;that&nbsp;we&nbsp;matched&nbsp;so&nbsp;far,&nbsp;then&nbsp;we&nbsp;can&nbsp;treat&nbsp;the&nbsp;end</span><br><span style="color: green">#&nbsp;of&nbsp;that&nbsp;matching&nbsp;prefix&nbsp;as&nbsp;the&nbsp;start&nbsp;of&nbsp;a&nbsp;prefix&nbsp;of&nbsp;the&nbsp;word&nbsp;that&nbsp;occurs</span><br><span style="color: green">#&nbsp;later&nbsp;in&nbsp;the&nbsp;target.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;The&nbsp;basic&nbsp;idea&nbsp;behind&nbsp;KMP&nbsp;is,&nbsp;given&nbsp;this&nbsp;table,&nbsp;to&nbsp;execute&nbsp;the&nbsp;following:</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;-&nbsp;Guess&nbsp;that&nbsp;the&nbsp;string&nbsp;starts&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;target.</span><br><span style="color: green">#&nbsp;&nbsp;-&nbsp;Match&nbsp;as&nbsp;much&nbsp;of&nbsp;the&nbsp;string&nbsp;as&nbsp;possible.</span><br><span style="color: green">#&nbsp;&nbsp;-&nbsp;If&nbsp;the&nbsp;whole&nbsp;string&nbsp;matched,&nbsp;we're&nbsp;done.</span><br><span style="color: green">#&nbsp;&nbsp;-&nbsp;Otherwise,&nbsp;a&nbsp;mismatch&nbsp;was&nbsp;found.&nbsp;&nbsp;Look&nbsp;up&nbsp;the&nbsp;largest&nbsp;border&nbsp;of&nbsp;the</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;that&nbsp;was&nbsp;matched&nbsp;so&nbsp;far&nbsp;in&nbsp;the&nbsp;failure&nbsp;table.&nbsp;&nbsp;Suppose&nbsp;it&nbsp;has</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;length&nbsp;k.</span><br><span style="color: green">#&nbsp;&nbsp;-&nbsp;Update&nbsp;our&nbsp;guess&nbsp;of&nbsp;the&nbsp;start&nbsp;position&nbsp;to&nbsp;be&nbsp;where&nbsp;that&nbsp;border&nbsp;occurs</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;portion&nbsp;matched&nbsp;so&nbsp;far,&nbsp;then&nbsp;repeat&nbsp;this&nbsp;process.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;Notice&nbsp;that&nbsp;once&nbsp;we've&nbsp;matched&nbsp;a&nbsp;character&nbsp;against&nbsp;part&nbsp;of&nbsp;the&nbsp;pattern&nbsp;(or</span><br><span style="color: green">#&nbsp;found&nbsp;that&nbsp;it&nbsp;can't&nbsp;possibly&nbsp;match),&nbsp;we&nbsp;never&nbsp;visit&nbsp;that&nbsp;character&nbsp;again.</span><br><span style="color: green">#&nbsp;This&nbsp;is&nbsp;responsible&nbsp;for&nbsp;the&nbsp;fast&nbsp;runtime&nbsp;of&nbsp;the&nbsp;algorithm&nbsp;(though&nbsp;I'll&nbsp;give&nbsp;a</span><br><span style="color: green">#&nbsp;more&nbsp;formal&nbsp;description&nbsp;later&nbsp;on).</span><br><br><span style="color: green">#&nbsp;Function:&nbsp;failTable(pattern)</span><br><span style="color: green">#&nbsp;Usage:&nbsp;failTable(&quot;This&nbsp;is&nbsp;a&nbsp;string!&quot;)</span><br><span style="color: green">#&nbsp;-----------------------------------------------------------------------------</span><br><span style="color: green">#&nbsp;Given&nbsp;a&nbsp;string,&nbsp;constructs&nbsp;the&nbsp;KMP&nbsp;failure&nbsp;table&nbsp;for&nbsp;that&nbsp;string.&nbsp;&nbsp;The&nbsp;values</span><br><span style="color: green">#&nbsp;in&nbsp;the&nbsp;table&nbsp;are&nbsp;defined&nbsp;as</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;table[i]&nbsp;=&nbsp;|LongestProperBoundary(pattern[0:i)])|</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;Where&nbsp;the&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;of&nbsp;a&nbsp;string&nbsp;is&nbsp;the&nbsp;longest&nbsp;proper&nbsp;substring</span><br><span style="color: green">#&nbsp;of&nbsp;that&nbsp;string&nbsp;that&nbsp;is&nbsp;both&nbsp;a&nbsp;prefix&nbsp;and&nbsp;a&nbsp;suffix.&nbsp;&nbsp;For&nbsp;example,&nbsp;given&nbsp;the</span><br><span style="color: green">#&nbsp;string&nbsp;&quot;abcabc,&quot;&nbsp;the&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;is&nbsp;abc.&nbsp;&nbsp;Similarly,&nbsp;given&nbsp;the</span><br><span style="color: green">#&nbsp;string&nbsp;&quot;apple,&quot;&nbsp;the&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;is&nbsp;the&nbsp;empty&nbsp;string.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;As&nbsp;a&nbsp;sample&nbsp;output&nbsp;of&nbsp;this&nbsp;function,&nbsp;given&nbsp;the&nbsp;string&nbsp;&quot;ababcac&quot;,&nbsp;the&nbsp;table</span><br><span style="color: green">#&nbsp;would&nbsp;be</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b&nbsp;a&nbsp;b&nbsp;c&nbsp;a&nbsp;c</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;0&nbsp;0&nbsp;1&nbsp;2&nbsp;0&nbsp;1&nbsp;0</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;This&nbsp;means,&nbsp;for&nbsp;example,&nbsp;that&nbsp;the&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;of&nbsp;the&nbsp;prefix&nbsp;&quot;aba&quot;</span><br><span style="color: green">#&nbsp;has&nbsp;length&nbsp;1,&nbsp;while&nbsp;the&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;of&nbsp;the&nbsp;string&nbsp;as&nbsp;a&nbsp;whole&nbsp;is</span><br><span style="color: green">#&nbsp;the&nbsp;empty&nbsp;string.&nbsp;&nbsp;Notice&nbsp;that&nbsp;the&nbsp;first&nbsp;entry&nbsp;is&nbsp;*,&nbsp;which&nbsp;we&nbsp;have&nbsp;chosen</span><br><span style="color: green">#&nbsp;because&nbsp;there&nbsp;is&nbsp;no&nbsp;mathematically&nbsp;well-defined&nbsp;proper&nbsp;substring&nbsp;of&nbsp;the&nbsp;empty</span><br><span style="color: green">#&nbsp;string.&nbsp;&nbsp;We&nbsp;can&nbsp;put&nbsp;anything&nbsp;we&nbsp;want&nbsp;there,&nbsp;and&nbsp;we'll&nbsp;go&nbsp;with&nbsp;None.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;To&nbsp;compute&nbsp;the&nbsp;values&nbsp;of&nbsp;this&nbsp;table,&nbsp;we&nbsp;use&nbsp;a&nbsp;dynamic&nbsp;programming&nbsp;algorithm</span><br><span style="color: green">#&nbsp;to&nbsp;compute&nbsp;a&nbsp;slightly&nbsp;stronger&nbsp;version&nbsp;of&nbsp;the&nbsp;function.&nbsp;&nbsp;We&nbsp;define&nbsp;the</span><br><span style="color: green">#&nbsp;function&nbsp;&quot;Extended&nbsp;Longest&nbsp;Proper&nbsp;Boundary&quot;&nbsp;(xLPB)&nbsp;as&nbsp;follows:</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;xLPB(string,&nbsp;n,&nbsp;char)&nbsp;=&nbsp;The&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;of&nbsp;string[0:n]&nbsp;+&nbsp;char</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;The&nbsp;idea&nbsp;behind&nbsp;this&nbsp;function&nbsp;is&nbsp;that&nbsp;we&nbsp;want&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;recycle&nbsp;the</span><br><span style="color: green">#&nbsp;values&nbsp;of&nbsp;the&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;function&nbsp;for&nbsp;smaller&nbsp;prefixes&nbsp;of&nbsp;the</span><br><span style="color: green">#&nbsp;string&nbsp;in&nbsp;order&nbsp;to&nbsp;compute&nbsp;the&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;for&nbsp;longer&nbsp;prefixes.</span><br><span style="color: green">#&nbsp;To&nbsp;make&nbsp;this&nbsp;easier,&nbsp;the&nbsp;xLPB&nbsp;function&nbsp;allows&nbsp;us&nbsp;to&nbsp;talk&nbsp;about&nbsp;what&nbsp;would</span><br><span style="color: green">#&nbsp;happen&nbsp;if&nbsp;we&nbsp;extended&nbsp;the&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;of&nbsp;some&nbsp;prefix&nbsp;of&nbsp;the</span><br><span style="color: green">#&nbsp;string&nbsp;by&nbsp;a&nbsp;single&nbsp;character.&nbsp;&nbsp;Notice&nbsp;that&nbsp;for&nbsp;any&nbsp;nonzero&nbsp;n,&nbsp;we&nbsp;have&nbsp;that</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;LongestProperBoundary(string[0:n])&nbsp;=&nbsp;xLPB(string,&nbsp;n&nbsp;-&nbsp;1,&nbsp;string[n])</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;That&nbsp;is,&nbsp;we&nbsp;simply&nbsp;tear&nbsp;off&nbsp;the&nbsp;last&nbsp;character&nbsp;and&nbsp;use&nbsp;it&nbsp;as&nbsp;the&nbsp;final</span><br><span style="color: green">#&nbsp;argument&nbsp;to&nbsp;xLPB.&nbsp;&nbsp;Given&nbsp;this&nbsp;xLPB&nbsp;function,&nbsp;we&nbsp;can&nbsp;compute&nbsp;its&nbsp;values</span><br><span style="color: green">#&nbsp;recursively&nbsp;using&nbsp;the&nbsp;following&nbsp;logic.&nbsp;&nbsp;As&nbsp;a&nbsp;base&nbsp;case,&nbsp;xLPB(string,&nbsp;0,&nbsp;char)</span><br><span style="color: green">#&nbsp;is&nbsp;the&nbsp;longest&nbsp;proper&nbsp;boundary&nbsp;of&nbsp;string[0:0]&nbsp;+&nbsp;char&nbsp;=&nbsp;char.&nbsp;&nbsp;But&nbsp;this&nbsp;has</span><br><span style="color: green">#&nbsp;only&nbsp;one&nbsp;proper&nbsp;boundary,&nbsp;the&nbsp;empty&nbsp;string,&nbsp;and&nbsp;so&nbsp;its&nbsp;value&nbsp;must&nbsp;be&nbsp;zero.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;Now&nbsp;suppose&nbsp;that&nbsp;for&nbsp;all&nbsp;n'&nbsp;&lt;&nbsp;n&nbsp;we&nbsp;have&nbsp;the&nbsp;value&nbsp;of&nbsp;xLPB(string,&nbsp;n',&nbsp;char)</span><br><span style="color: green">#&nbsp;for&nbsp;any&nbsp;character&nbsp;char.&nbsp;&nbsp;Suppose&nbsp;we&nbsp;want&nbsp;to&nbsp;go&nbsp;and&nbsp;compute</span><br><span style="color: green">#&nbsp;xLPB(string,&nbsp;n,&nbsp;char).&nbsp;&nbsp;Let's&nbsp;think&nbsp;about&nbsp;what&nbsp;this&nbsp;would&nbsp;mean.&nbsp;&nbsp;Given&nbsp;that</span><br><span style="color: green">#&nbsp;n&nbsp;is&nbsp;not&nbsp;zero,&nbsp;we&nbsp;can&nbsp;think&nbsp;of&nbsp;this&nbsp;problem&nbsp;as&nbsp;trying&nbsp;to&nbsp;find&nbsp;the&nbsp;longest</span><br><span style="color: green">#&nbsp;proper&nbsp;boundary&nbsp;of&nbsp;this&nbsp;string:</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+------------+---+------------+------------+---+</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPB&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;?&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPB&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;c&nbsp;|</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+------------+---+------------+------------+---+</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^&nbsp;^</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+----------------------+-------------------+&nbsp;|</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;of&nbsp;length&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New&nbsp;character</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;The&nbsp;idea&nbsp;is&nbsp;that&nbsp;we&nbsp;have&nbsp;the&nbsp;original&nbsp;string&nbsp;of&nbsp;length&nbsp;n,&nbsp;followed&nbsp;by&nbsp;our&nbsp;new</span><br><span style="color: green">#&nbsp;character&nbsp;char&nbsp;(which&nbsp;we'll&nbsp;abbreviate&nbsp;c).&nbsp;&nbsp;In&nbsp;this&nbsp;diagram,&nbsp;I've&nbsp;marked&nbsp;the</span><br><span style="color: green">#&nbsp;LPB&nbsp;of&nbsp;the&nbsp;string&nbsp;of&nbsp;length&nbsp;n.&nbsp;&nbsp;Notice&nbsp;that&nbsp;right&nbsp;after&nbsp;the&nbsp;LPB&nbsp;at&nbsp;the&nbsp;prefix</span><br><span style="color: green">#&nbsp;of&nbsp;the&nbsp;string,&nbsp;we&nbsp;have&nbsp;some&nbsp;character&nbsp;whose&nbsp;value&nbsp;is&nbsp;unknown&nbsp;(since&nbsp;n&nbsp;!=&nbsp;0</span><br><span style="color: green">#&nbsp;and&nbsp;the&nbsp;LPB&nbsp;can't&nbsp;be&nbsp;the&nbsp;whole&nbsp;string).&nbsp;&nbsp;If&nbsp;this&nbsp;value&nbsp;is&nbsp;equal&nbsp;to&nbsp;c,&nbsp;then</span><br><span style="color: green">#&nbsp;the&nbsp;LPB&nbsp;of&nbsp;the&nbsp;whole&nbsp;string&nbsp;can&nbsp;be&nbsp;formed&nbsp;by&nbsp;simply&nbsp;extending&nbsp;the&nbsp;LPB&nbsp;of&nbsp;the</span><br><span style="color: green">#&nbsp;first&nbsp;n&nbsp;characters.&nbsp;&nbsp;There&nbsp;can't&nbsp;be&nbsp;a&nbsp;longer&nbsp;proper&nbsp;boundary,&nbsp;since&nbsp;otherwise</span><br><span style="color: green">#&nbsp;we&nbsp;could&nbsp;show&nbsp;that&nbsp;by&nbsp;taking&nbsp;that&nbsp;longer&nbsp;boundary&nbsp;and&nbsp;dropping&nbsp;off&nbsp;the</span><br><span style="color: green">#&nbsp;character&nbsp;c,&nbsp;we'd&nbsp;end&nbsp;up&nbsp;with&nbsp;a&nbsp;longer&nbsp;proper&nbsp;boundary&nbsp;for&nbsp;the&nbsp;first&nbsp;n</span><br><span style="color: green">#&nbsp;characters&nbsp;of&nbsp;the&nbsp;string,&nbsp;contradicting&nbsp;that&nbsp;we&nbsp;chose&nbsp;the&nbsp;longest&nbsp;proper</span><br><span style="color: green">#&nbsp;boundary.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;By&nbsp;our&nbsp;above&nbsp;argument,&nbsp;remember&nbsp;that&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;longest&nbsp;proper</span><br><span style="color: green">#&nbsp;boundary&nbsp;of&nbsp;the&nbsp;first&nbsp;n&nbsp;characters&nbsp;of&nbsp;the&nbsp;string&nbsp;is&nbsp;given&nbsp;by</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;xLPB(string,&nbsp;n&nbsp;-&nbsp;1,&nbsp;string[n&nbsp;-&nbsp;1])</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;Thus&nbsp;we&nbsp;have&nbsp;the&nbsp;first&nbsp;part&nbsp;of&nbsp;our&nbsp;recurrence,&nbsp;which&nbsp;is&nbsp;defined&nbsp;as</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;xLPB(string,&nbsp;n,&nbsp;char)&nbsp;=</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;0,&nbsp;then&nbsp;0.</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;k&nbsp;=&nbsp;xLPB(string,&nbsp;n&nbsp;-&nbsp;1,&nbsp;string[n&nbsp;-&nbsp;1])</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;string[k]&nbsp;==&nbsp;char,&nbsp;return&nbsp;k&nbsp;+&nbsp;1</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else,&nbsp;???</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;Now,&nbsp;suppose&nbsp;that&nbsp;we&nbsp;find&nbsp;that&nbsp;the&nbsp;character&nbsp;after&nbsp;the&nbsp;LPB&nbsp;does&nbsp;not&nbsp;match.</span><br><span style="color: green">#&nbsp;If&nbsp;this&nbsp;happens,&nbsp;we&nbsp;can&nbsp;then&nbsp;make&nbsp;the&nbsp;following&nbsp;observation.&nbsp;&nbsp;Below&nbsp;I've</span><br><span style="color: green">#&nbsp;reprinted&nbsp;the&nbsp;above&nbsp;diagram:</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+------------+---+------------+------------+---+</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPB&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;?&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPB&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;c&nbsp;|</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+------------+---+------------+------------+---+</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^&nbsp;^</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+----------------------+-------------------+&nbsp;|</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;of&nbsp;length&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New&nbsp;character</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;Notice&nbsp;that&nbsp;any&nbsp;LPB&nbsp;of&nbsp;this&nbsp;new&nbsp;string&nbsp;must&nbsp;be&nbsp;a&nbsp;prefix&nbsp;of&nbsp;the&nbsp;LPB&nbsp;of&nbsp;the</span><br><span style="color: green">#&nbsp;first&nbsp;n&nbsp;characters&nbsp;and&nbsp;a&nbsp;suffix&nbsp;of&nbsp;the&nbsp;LPB&nbsp;followed&nbsp;by&nbsp;the&nbsp;character&nbsp;c.</span><br><span style="color: green">#&nbsp;Since&nbsp;by&nbsp;definition&nbsp;the&nbsp;LPB&nbsp;of&nbsp;the&nbsp;first&nbsp;n&nbsp;characters&nbsp;must&nbsp;be&nbsp;a&nbsp;prefix&nbsp;of</span><br><span style="color: green">#&nbsp;those&nbsp;n&nbsp;characters,&nbsp;we&nbsp;have&nbsp;the&nbsp;following&nbsp;elegant&nbsp;conclusion&nbsp;to&nbsp;our</span><br><span style="color: green">#&nbsp;recurrence:</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;xLPB(string,&nbsp;n,&nbsp;char)&nbsp;=</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;0,&nbsp;then&nbsp;0.</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;k&nbsp;=&nbsp;xLPB(string,&nbsp;n&nbsp;-&nbsp;1,&nbsp;string[n&nbsp;-&nbsp;1])</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;string[k]&nbsp;==&nbsp;char,&nbsp;return&nbsp;k&nbsp;+&nbsp;1</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else,&nbsp;xLPB(string,&nbsp;k,&nbsp;char)</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;The&nbsp;reason&nbsp;for&nbsp;this&nbsp;is&nbsp;that&nbsp;xLPB(string,&nbsp;k,&nbsp;char)&nbsp;asks&nbsp;for&nbsp;the&nbsp;longest</span><br><span style="color: green">#&nbsp;proper&nbsp;boundary&nbsp;of&nbsp;the&nbsp;LPB&nbsp;of&nbsp;the&nbsp;string&nbsp;formed&nbsp;from&nbsp;the&nbsp;first&nbsp;n&nbsp;characters</span><br><span style="color: green">#&nbsp;of&nbsp;the&nbsp;string&nbsp;followed&nbsp;by&nbsp;the&nbsp;character&nbsp;c,&nbsp;which&nbsp;is&nbsp;exactly&nbsp;what&nbsp;we&nbsp;described</span><br><span style="color: green">#&nbsp;above.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;As&nbsp;written,&nbsp;filling&nbsp;in&nbsp;the&nbsp;table&nbsp;of&nbsp;LPB&nbsp;values&nbsp;would&nbsp;take&nbsp;O(n^2)&nbsp;time,&nbsp;where</span><br><span style="color: green">#&nbsp;n&nbsp;is&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;However,&nbsp;using&nbsp;dynamic&nbsp;programming&nbsp;and&nbsp;an</span><br><span style="color: green">#&nbsp;amortized&nbsp;analysis,&nbsp;we&nbsp;can&nbsp;show&nbsp;that&nbsp;this&nbsp;function&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;run&nbsp;in</span><br><span style="color: green">#&nbsp;O(n)&nbsp;time.&nbsp;&nbsp;In&nbsp;particular,&nbsp;suppose&nbsp;that&nbsp;for&nbsp;all&nbsp;n'&nbsp;&lt;&nbsp;n,&nbsp;we&nbsp;know&nbsp;the&nbsp;value&nbsp;of</span><br><span style="color: green">#&nbsp;LPB(string[0:n]).&nbsp;&nbsp;Then&nbsp;in&nbsp;the&nbsp;above&nbsp;formulation&nbsp;of&nbsp;xLPB,&nbsp;the&nbsp;first</span><br><span style="color: green">#&nbsp;recursive&nbsp;call&nbsp;is&nbsp;known,&nbsp;and&nbsp;the&nbsp;only&nbsp;recursive&nbsp;call&nbsp;we&nbsp;may&nbsp;actually&nbsp;need&nbsp;to</span><br><span style="color: green">#&nbsp;make&nbsp;is&nbsp;the&nbsp;second.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;However,&nbsp;this&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;say&nbsp;anything&nbsp;about&nbsp;the&nbsp;runtime&nbsp;of&nbsp;the&nbsp;second</span><br><span style="color: green">#&nbsp;recursive&nbsp;call,&nbsp;which&nbsp;seems&nbsp;as&nbsp;though&nbsp;it&nbsp;might&nbsp;cause&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;this</span><br><span style="color: green">#&nbsp;function&nbsp;to&nbsp;run&nbsp;in&nbsp;time&nbsp;O(n).&nbsp;&nbsp;This&nbsp;is&nbsp;correct,&nbsp;but&nbsp;in&nbsp;an&nbsp;*amortized*&nbsp;sense</span><br><span style="color: green">#&nbsp;the&nbsp;whole&nbsp;table&nbsp;can&nbsp;still&nbsp;be&nbsp;computed&nbsp;in&nbsp;O(n)&nbsp;time&nbsp;overall.&nbsp;&nbsp;To&nbsp;see&nbsp;this,</span><br><span style="color: green">#&nbsp;let's&nbsp;define&nbsp;a&nbsp;potential&nbsp;function&nbsp;Phi(k)&nbsp;that&nbsp;associates&nbsp;a&nbsp;potential&nbsp;at&nbsp;each</span><br><span style="color: green">#&nbsp;point&nbsp;of&nbsp;the&nbsp;computation&nbsp;of&nbsp;the&nbsp;table.&nbsp;&nbsp;In&nbsp;particular,&nbsp;define&nbsp;Phi(k)&nbsp;as</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;Phi(0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;Phi(k&nbsp;+&nbsp;1)&nbsp;=&nbsp;result[k&nbsp;-&nbsp;1]</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;Here,&nbsp;result&nbsp;is&nbsp;the&nbsp;resulting&nbsp;table&nbsp;of&nbsp;LPB&nbsp;values.&nbsp;&nbsp;Because&nbsp;of&nbsp;this,&nbsp;we&nbsp;can</span><br><span style="color: green">#&nbsp;remark&nbsp;that&nbsp;result[k]&nbsp;&lt;&nbsp;k,&nbsp;since&nbsp;the&nbsp;longest&nbsp;proper&nbsp;border&nbsp;of&nbsp;a&nbsp;string&nbsp;can't</span><br><span style="color: green">#&nbsp;be&nbsp;any&nbsp;longer&nbsp;than&nbsp;that&nbsp;string.</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;Let's&nbsp;now&nbsp;show&nbsp;that&nbsp;this&nbsp;potential&nbsp;function&nbsp;gives&nbsp;an&nbsp;amortized&nbsp;O(1)&nbsp;cost&nbsp;for</span><br><span style="color: green">#&nbsp;each&nbsp;table&nbsp;entry&nbsp;computation,&nbsp;and&nbsp;thus&nbsp;an&nbsp;O(n)&nbsp;overall&nbsp;runtime&nbsp;for&nbsp;the&nbsp;table-</span><br><span style="color: green">#&nbsp;building&nbsp;algorithm.&nbsp;&nbsp;To&nbsp;see&nbsp;this,&nbsp;consider&nbsp;what&nbsp;happens&nbsp;when&nbsp;the&nbsp;logic&nbsp;to</span><br><span style="color: green">#&nbsp;compute&nbsp;the&nbsp;next&nbsp;value&nbsp;runs.&nbsp;&nbsp;The&nbsp;runtime&nbsp;for&nbsp;this&nbsp;step&nbsp;is&nbsp;bounded&nbsp;by&nbsp;the</span><br><span style="color: green">#&nbsp;number&nbsp;of&nbsp;recursive&nbsp;calls&nbsp;made&nbsp;to&nbsp;a&nbsp;subproblem.&nbsp;&nbsp;However,&nbsp;each&nbsp;subproblem&nbsp;is</span><br><span style="color: green">#&nbsp;then&nbsp;of&nbsp;size&nbsp;given&nbsp;by&nbsp;the&nbsp;LPB&nbsp;of&nbsp;a&nbsp;slightly&nbsp;smaller&nbsp;problem.&nbsp;&nbsp;This&nbsp;subproblem</span><br><span style="color: green">#&nbsp;must&nbsp;then&nbsp;have&nbsp;size&nbsp;at&nbsp;most&nbsp;the&nbsp;size&nbsp;of&nbsp;that&nbsp;smaller&nbsp;subproblem.&nbsp;&nbsp;In&nbsp;other</span><br><span style="color: green">#&nbsp;words,&nbsp;we&nbsp;can&nbsp;say&nbsp;that&nbsp;each&nbsp;recursive&nbsp;call&nbsp;drops&nbsp;the&nbsp;maximum&nbsp;possible&nbsp;value</span><br><span style="color: green">#&nbsp;of&nbsp;the&nbsp;LPB&nbsp;for&nbsp;the&nbsp;current&nbsp;prefix&nbsp;by&nbsp;at&nbsp;least&nbsp;one.&nbsp;&nbsp;Consequently,&nbsp;if&nbsp;k</span><br><span style="color: green">#&nbsp;recursive&nbsp;calls&nbsp;are&nbsp;made,&nbsp;the&nbsp;LPB&nbsp;of&nbsp;the&nbsp;current&nbsp;prefix&nbsp;is&nbsp;at&nbsp;least&nbsp;k&nbsp;smaller</span><br><span style="color: green">#&nbsp;than&nbsp;the&nbsp;LPB&nbsp;of&nbsp;the&nbsp;previous&nbsp;prefix,&nbsp;and&nbsp;so</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;&nbsp;&nbsp;D&nbsp;Phi&nbsp;=&nbsp;-k</span><br><span style="color: green">#</span><br><span style="color: green">#&nbsp;And&nbsp;so&nbsp;the&nbsp;amortized&nbsp;cost&nbsp;of&nbsp;computing&nbsp;the&nbsp;next&nbsp;term&nbsp;is&nbsp;1&nbsp;+&nbsp;k&nbsp;-&nbsp;k&nbsp;=&nbsp;O(1).</span><br><br><span style="color: blue">def</span>&nbsp;failTable<span style="color: navy">(</span>pattern<span style="color: navy">):</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Create&nbsp;the&nbsp;resulting&nbsp;table,&nbsp;which&nbsp;for&nbsp;length&nbsp;zero&nbsp;is&nbsp;None.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;<span style="color: navy">=</span>&nbsp;<span style="color: navy">[</span><span style="color: #800000">None</span><span style="color: navy">]</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Iterate&nbsp;across&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;characters,&nbsp;filling&nbsp;in&nbsp;the&nbsp;values&nbsp;for&nbsp;the</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;rest&nbsp;of&nbsp;the&nbsp;table.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">for</span>&nbsp;i&nbsp;<span style="color: blue">in</span>&nbsp;range<span style="color: navy">(</span><span style="color: orange">0</span><span style="color: navy">,</span>&nbsp;len<span style="color: navy">(</span>pattern<span style="color: navy">)):</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Keep&nbsp;track&nbsp;of&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;subproblem&nbsp;we're&nbsp;dealing&nbsp;with,&nbsp;which</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;starts&nbsp;off&nbsp;using&nbsp;the&nbsp;first&nbsp;i&nbsp;characters&nbsp;of&nbsp;the&nbsp;string.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;<span style="color: navy">=</span>&nbsp;i<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">while</span>&nbsp;<span style="color: #800000">True</span><span style="color: navy">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;If&nbsp;j&nbsp;hits&nbsp;zero,&nbsp;the&nbsp;recursion&nbsp;says&nbsp;that&nbsp;the&nbsp;resulting&nbsp;value&nbsp;is</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;zero&nbsp;since&nbsp;we're&nbsp;looking&nbsp;for&nbsp;the&nbsp;LPB&nbsp;of&nbsp;a&nbsp;single-character</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;string.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">if</span>&nbsp;j&nbsp;<span style="color: navy">==</span>&nbsp;<span style="color: orange">0</span><span style="color: navy">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result<span style="color: navy">.</span>append<span style="color: navy">(</span><span style="color: orange">0</span><span style="color: navy">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">break</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Otherwise,&nbsp;if&nbsp;the&nbsp;character&nbsp;one&nbsp;step&nbsp;after&nbsp;the&nbsp;LPB&nbsp;matches&nbsp;the</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;next&nbsp;character&nbsp;in&nbsp;the&nbsp;sequence,&nbsp;then&nbsp;we&nbsp;can&nbsp;extend&nbsp;the&nbsp;LPB&nbsp;by&nbsp;one</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;character&nbsp;to&nbsp;get&nbsp;an&nbsp;LPB&nbsp;for&nbsp;the&nbsp;whole&nbsp;sequence.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">if</span>&nbsp;pattern<span style="color: navy">[</span>result<span style="color: navy">[</span>j<span style="color: navy">]]</span>&nbsp;<span style="color: navy">==</span>&nbsp;pattern<span style="color: navy">[</span>i<span style="color: navy">]:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result<span style="color: navy">.</span>append<span style="color: navy">(</span>result<span style="color: navy">[</span>j<span style="color: navy">]</span>&nbsp;<span style="color: navy">+</span>&nbsp;<span style="color: orange">1</span><span style="color: navy">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">break</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Finally,&nbsp;if&nbsp;neither&nbsp;of&nbsp;these&nbsp;hold,&nbsp;then&nbsp;we&nbsp;need&nbsp;to&nbsp;reduce&nbsp;the</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;subproblem&nbsp;to&nbsp;the&nbsp;LPB&nbsp;of&nbsp;the&nbsp;LPB.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;<span style="color: navy">=</span>&nbsp;result<span style="color: navy">[</span>j<span style="color: navy">]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">return</span>&nbsp;result<br><br><span style="color: green">#&nbsp;Function:&nbsp;kmpMatch(needle,&nbsp;haystack)</span><br><span style="color: green">#&nbsp;Usage:&nbsp;print&nbsp;kmpMatch(&quot;0101&quot;,&nbsp;&quot;0011001011&quot;)&nbsp;#&nbsp;Prints&nbsp;5</span><br><span style="color: green">#&nbsp;-----------------------------------------------------------------------------</span><br><span style="color: green">#&nbsp;Uses&nbsp;the&nbsp;KMP&nbsp;algorithm&nbsp;to&nbsp;find&nbsp;an&nbsp;occurrence&nbsp;of&nbsp;the&nbsp;specified&nbsp;needle&nbsp;string</span><br><span style="color: green">#&nbsp;in&nbsp;the&nbsp;haystack&nbsp;string.&nbsp;&nbsp;To&nbsp;do&nbsp;this,&nbsp;we&nbsp;compute&nbsp;the&nbsp;failure&nbsp;table,&nbsp;which</span><br><span style="color: green">#&nbsp;is&nbsp;done&nbsp;above.&nbsp;&nbsp;Next,&nbsp;we&nbsp;iterate&nbsp;across&nbsp;the&nbsp;string,&nbsp;keeping&nbsp;track&nbsp;of&nbsp;a</span><br><span style="color: green">#&nbsp;candidate&nbsp;start&nbsp;point&nbsp;and&nbsp;length&nbsp;matched&nbsp;so&nbsp;far.&nbsp;&nbsp;Whenever&nbsp;a&nbsp;match&nbsp;occurs,&nbsp;we</span><br><span style="color: green">#&nbsp;update&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;match&nbsp;we've&nbsp;made.&nbsp;&nbsp;On&nbsp;a&nbsp;failure,&nbsp;we&nbsp;update&nbsp;these</span><br><span style="color: green">#&nbsp;values&nbsp;by&nbsp;trying&nbsp;to&nbsp;preserve&nbsp;the&nbsp;maximum&nbsp;proper&nbsp;border&nbsp;of&nbsp;the&nbsp;string&nbsp;we&nbsp;were</span><br><span style="color: green">#&nbsp;able&nbsp;to&nbsp;manage&nbsp;by&nbsp;that&nbsp;point.</span><br><span style="color: blue">def</span>&nbsp;kmpMatch<span style="color: navy">(</span>needle<span style="color: navy">,</span>&nbsp;haystack<span style="color: navy">):</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Compute&nbsp;the&nbsp;failure&nbsp;table&nbsp;for&nbsp;the&nbsp;needle&nbsp;we're&nbsp;looking&nbsp;up.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;fail&nbsp;<span style="color: navy">=</span>&nbsp;failTable<span style="color: navy">(</span>needle<span style="color: navy">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Keep&nbsp;track&nbsp;of&nbsp;the&nbsp;start&nbsp;index&nbsp;and&nbsp;next&nbsp;match&nbsp;position,&nbsp;both&nbsp;of&nbsp;which</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;start&nbsp;at&nbsp;zero&nbsp;since&nbsp;our&nbsp;candidate&nbsp;match&nbsp;is&nbsp;at&nbsp;the&nbsp;beginning&nbsp;and&nbsp;is&nbsp;trying</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;to&nbsp;match&nbsp;the&nbsp;first&nbsp;character.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;<span style="color: navy">=</span>&nbsp;<span style="color: orange">0</span><br>&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;<span style="color: navy">=</span>&nbsp;<span style="color: orange">0</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Loop&nbsp;until&nbsp;we&nbsp;fall&nbsp;off&nbsp;the&nbsp;string&nbsp;or&nbsp;match.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">while</span>&nbsp;index&nbsp;<span style="color: navy">+</span>&nbsp;match&nbsp;<span style="color: navy">&lt;</span>&nbsp;len<span style="color: navy">(</span>haystack<span style="color: navy">):</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">print</span>&nbsp;index<span style="color: navy">,</span>&nbsp;match<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;If&nbsp;the&nbsp;current&nbsp;character&nbsp;matches&nbsp;the&nbsp;expected&nbsp;character,&nbsp;then&nbsp;bump&nbsp;up</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;the&nbsp;match&nbsp;index.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">if</span>&nbsp;haystack<span style="color: navy">[</span>index&nbsp;<span style="color: navy">+</span>&nbsp;match<span style="color: navy">]</span>&nbsp;<span style="color: navy">==</span>&nbsp;needle<span style="color: navy">[</span>match<span style="color: navy">]:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;<span style="color: navy">=</span>&nbsp;match&nbsp;<span style="color: navy">+</span>&nbsp;<span style="color: orange">1</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;If&nbsp;we&nbsp;completely&nbsp;matched&nbsp;everything,&nbsp;we're&nbsp;done.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">if</span>&nbsp;match&nbsp;<span style="color: navy">==</span>&nbsp;len<span style="color: navy">(</span>needle<span style="color: navy">):</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">return</span>&nbsp;index<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Otherwise,&nbsp;we&nbsp;need&nbsp;to&nbsp;look&nbsp;at&nbsp;the&nbsp;fail&nbsp;table&nbsp;to&nbsp;determine&nbsp;what&nbsp;to&nbsp;do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;next.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">else</span><span style="color: navy">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;If&nbsp;we&nbsp;couldn't&nbsp;match&nbsp;the&nbsp;first&nbsp;character,&nbsp;then&nbsp;just&nbsp;advance&nbsp;the</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;start&nbsp;index.&nbsp;&nbsp;We&nbsp;need&nbsp;to&nbsp;try&nbsp;again.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">if</span>&nbsp;match&nbsp;<span style="color: navy">==</span>&nbsp;<span style="color: orange">0</span><span style="color: navy">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;<span style="color: navy">=</span>&nbsp;index&nbsp;<span style="color: navy">+</span>&nbsp;<span style="color: orange">1</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;Otherwise,&nbsp;see&nbsp;how&nbsp;much&nbsp;we&nbsp;need&nbsp;to&nbsp;skip&nbsp;forward&nbsp;before&nbsp;we&nbsp;have</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;another&nbsp;feasible&nbsp;match.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">else</span><span style="color: navy">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;<span style="color: navy">=</span>&nbsp;index&nbsp;<span style="color: navy">+</span>&nbsp;match&nbsp;<span style="color: navy">-</span>&nbsp;fail<span style="color: navy">[</span>match<span style="color: navy">]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;<span style="color: navy">=</span>&nbsp;fail<span style="color: navy">[</span>match<span style="color: navy">]</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green">#&nbsp;If&nbsp;we&nbsp;made&nbsp;it&nbsp;here,&nbsp;then&nbsp;no&nbsp;match&nbsp;was&nbsp;found.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">return</span>&nbsp;<span style="color: #800000">None</span><br>  </body>
</html>
